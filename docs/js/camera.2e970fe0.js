(self["webpackChunkinput_file_capture_demo"]=self["webpackChunkinput_file_capture_demo"]||[]).push([[85],{3278:function(e){const t={DOM:{target:".viewport"},CONSTRAINS:{video:{width:1280,height:720}}};e.exports=(e=t.DOM.target,a=t.CONSTRAINS)=>{const n={target:e,viewport:null,video:null,canvas:null},s=e=>{let t;t=e?"string"===typeof e?document.querySelector(e):e:document.querySelector(".viewport");let a=t.querySelector("canvas");a||(a=t.createElement("canvas"),t.appendChild(a));let s=t.querySelector("video");s||(s=document.createElement("video"),t.appendChild(s)),n.viewport=t,n.canvas=a,n.video=s},r={stream:null,videoTrack:null},o=async e=>{const t=await navigator.mediaDevices.getUserMedia(e);r.stream=t;const{video:a,canvas:s}=n;return a.srcObject=t,t.getVideoTracks().forEach((e=>{r.videoTrack=e;const t=e.getSettings();console.log("constraints",t),s.width=t.width,s.height=t.height})),t},i=(e,t)=>{const a=t.getContext("2d"),n={w:Math.floor(t.width),h:Math.floor(t.height)};a.clearRect(0,0,n.w,n.h),a.drawImage(e,0,0,n.w,n.h)},c={pause:!1},u=async()=>{let{stream:e}=r;return e||(e=await o(a)),e&&(c.pause=!1,e.getVideoTracks().forEach((e=>{e.enabled=!0})),requestAnimationFrame(p)),r.stream},l=async()=>{try{const{stream:e}=r;return e&&(c.pause=!0,e.getVideoTracks().forEach((e=>{e.enabled=!1}))),Promise.resolve(e)}catch(e){return Promise.reject(e)}},d=async()=>{try{const{stream:e}=r;return e&&(e.getTracks().forEach((e=>{e.enabled=!0,e.stop()})),r.stream=null,c.pause=!1),Promise.resolve(e)}catch(e){return Promise.reject(e)}},p=()=>{if(!c.pause){const{video:e,canvas:t}=n;i(e,t),setTimeout(requestAnimationFrame(p),1e3/30)}};return{async init(){return new Promise((t=>(s(e),t(this))))},async start(){return await u()},async pause(){return await l()},async stop(){return await d()}}}},4586:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return w}});var n=a(3396);const s=e=>((0,n.dD)("data-v-749243b2"),e=e(),(0,n.Cn)(),e),r={class:"wapper"},o=s((()=>(0,n._)("section",{class:"viewport"},[(0,n._)("canvas"),(0,n._)("video",{autoplay:"",playsinline:""})],-1))),i={class:"fixed-bottom"};function c(e,t){return(0,n.wg)(),(0,n.iD)("main",r,[o,(0,n._)("section",i,[(0,n._)("button",{onClick:t[0]||(t[0]=(...t)=>e.start&&e.start(...t))},"start"),(0,n._)("button",{onClick:t[1]||(t[1]=(...t)=>e.pause&&e.pause(...t))},"pause"),(0,n._)("button",{onClick:t[2]||(t[2]=(...t)=>e.stop&&e.stop(...t))},"stop")])])}var u=a(4870),l=a(3278),d=a.n(l);const p=()=>{const e=(0,u.iH)({instance:null}),t=()=>{const t=e.value.instance;t.start()},a=()=>{const t=e.value.instance;t.pause()},s=()=>{const t=e.value.instance;t.stop()};return(0,n.bv)((()=>{const t=e.value.instance=d()(".viewport",{video:{width:{min:160,ideal:1200,max:10240},height:{min:120,ideal:720,max:4320},facingMode:"environment"}});t.init().then((e=>{e.start()}))})),(0,n.Ah)((()=>{const t=e.value;t&&t.stop()})),{start:t,pause:a,stop:s}};var v=(0,n.aZ)({name:"p-camera",setup:p}),m=a(89);const h=(0,m.Z)(v,[["render",c],["__scopeId","data-v-749243b2"]]);var w=h}}]);
//# sourceMappingURL=camera.2e970fe0.js.map