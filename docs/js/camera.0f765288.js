(self["webpackChunkinput_file_capture_demo"]=self["webpackChunkinput_file_capture_demo"]||[]).push([[85],{3278:function(e){const t={DOM:{target:".viewport"},CONSTRAINS:{video:{width:1280,height:720}}};e.exports=(e=t.DOM.target,a=t.CONSTRAINS)=>{const s={target:e,viewport:null,video:null,canvas:null},n=e=>{let t;t=e?"string"===typeof e?document.querySelector(e):e:document.querySelector(".viewport");let a=t.querySelector("canvas");a||(a=t.createElement("canvas"),t.appendChild(a));let n=t.querySelector("video");n||(n=document.createElement("video"),t.appendChild(n)),s.viewport=t,s.canvas=a,s.video=n},r={stream:null,videoTrack:null},i=async e=>{try{const t=await navigator.mediaDevices.getUserMedia(e);r.stream=t;const{video:a,canvas:n}=s;return a.srcObject=t,t.getVideoTracks().forEach((e=>{r.videoTrack=e;const t=e.getSettings();n.width=t.width,n.height=t.height})),t}catch(t){return Promise.reject(t)}},o=(e,t)=>{const a=t.getContext("2d"),s={w:Math.floor(t.width),h:Math.floor(t.height)};a.clearRect(0,0,s.w,s.h),a.drawImage(e,0,0,s.w,s.h)},c={pause:!1},l=async()=>{try{let{stream:e}=r;return e||(e=await i(a)),e&&(c.pause=!1,e.getVideoTracks().forEach((e=>{e.enabled=!0})),requestAnimationFrame(p)),Promise.resolve(r.stream)}catch(e){return Promise.reject(e)}},u=async()=>{try{const{stream:e}=r;return e&&(c.pause=!0,e.getVideoTracks().forEach((e=>{e.enabled=!1}))),Promise.resolve(e)}catch(e){return Promise.reject(e)}},d=async()=>{try{const{stream:e}=r;return e&&(e.getTracks().forEach((e=>{e.enabled=!0,e.stop()})),r.stream=null,c.pause=!1),Promise.resolve(e)}catch(e){return Promise.reject(e)}},p=()=>{if(!c.pause){const{video:e,canvas:t}=s;o(e,t),setTimeout(requestAnimationFrame(p),1e3/30)}};return{get DOM(){return s},async init(){return new Promise((t=>(n(e),t(this))))},async start(){return await l()},async pause(){return await u()},async stop(){return await d()}}}},2999:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return j}});var s=a(3396),n=a(7139),r=a(9242);const i=e=>((0,s.dD)("data-v-3ae02e9c"),e=e(),(0,s.Cn)(),e),o={class:"wapper"},c={class:"main"},l=i((()=>(0,s._)("section",{class:"camera camera-full"},[(0,s._)("div",{class:"viewport"},[(0,s._)("canvas"),(0,s._)("video",{autoplay:"",playsinline:""})])],-1))),u={class:"position-relative",style:{width:"100%",height:"100%"}},d=i((()=>(0,s._)("div",{class:"position-absolute top-50 start-50 translate-middle"},[(0,s._)("div",{class:"spinner-border",role:"status",style:{width:"3rem",height:"3rem"}},[(0,s._)("span",{class:"visually-hidden"},"Loading...")]),(0,s._)("p",null,"カメラの権限を確認中...")],-1))),p=[d],v={class:"fixed-top d-flex flex-row"},m=i((()=>(0,s._)("i",{class:"bi bi-x-square"},null,-1))),h=[m],b={class:"fixed-bottom"},g=i((()=>(0,s._)("i",{class:"bi bi-caret-right-square"},null,-1))),w=[g],_=i((()=>(0,s._)("i",{class:"bi bi-pause-circle"},null,-1))),f=[_],y=i((()=>(0,s._)("i",{class:"bi bi-stop-fill"},null,-1))),k=[y];function C(e,t){return(0,s.wg)(),(0,s.iD)("div",o,[(0,s._)("main",c,[l,(0,s._)("section",{class:(0,n.C_)(["cover",e.ui.loaded?"":"cover-loading"])},[(0,s.wy)((0,s._)("div",u,p,512),[[r.F8,!e.ui.loaded]])],2),(0,s._)("section",v,[(0,s.WI)(e.$slots,"close-button",{},(()=>[(0,s._)("button",{class:"btn btn-dark",onClick:t[0]||(t[0]=(...t)=>e.close&&e.close(...t))},h)]),!0)]),(0,s._)("section",b,[(0,s.WI)(e.$slots,"start-button",{},(()=>[(0,s._)("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=(...t)=>e.start&&e.start(...t))},w)]),!0),(0,s.WI)(e.$slots,"pause-button",{},(()=>[(0,s._)("button",{class:"btn btn-warning",onClick:t[2]||(t[2]=(...t)=>e.pause&&e.pause(...t))},f)]),!0),(0,s.WI)(e.$slots,"stop-button",{},(()=>[(0,s._)("button",{class:"btn btn-danger",onClick:t[3]||(t[3]=(...t)=>e.stop&&e.stop(...t))},k)]),!0)])])])}var D=a(4870),q=a(6542),x=a(3278),S=a.n(x);const T=(e,t)=>{const a=(0,q.tv)(),n=(0,D.iH)({instance:null}),r=(0,D.qj)({loaded:!1,error:""}),i=e=>{e&&e.preventDefault(),a.back()},o=e=>{e&&e.preventDefault();const a=n.value.instance;return a.start().then((e=>(console.log("start"),r.loaded=!0,t.emit("start",{data:a}),e))).catch((e=>(console.error(e),r.error=e,e)))},c=e=>{e&&e.preventDefault();const a=n.value.instance;return a.pause().then((e=>(t.emit("pause",{data:a}),e)))},l=e=>{e&&e.preventDefault(),r.loaded=!1;const a=n.value.instance;return a.stop().then((e=>(t.emit("stop",{data:a}),e)))};return(0,s.bv)((()=>{const e=n.value.instance=S()(".viewport",{video:{width:{min:160,ideal:1200,max:10240},height:{min:120,ideal:720,max:4320},facingMode:"environment"}});e.init().then((()=>{t.emit("init",{data:e})}))})),(0,s.Ah)((()=>{l()})),{ui:r,close:i,start:o,pause:c,stop:l}};var I=(0,s.aZ)({name:"p-camera",setup:T}),P=a(89);const M=(0,P.Z)(I,[["render",C],["__scopeId","data-v-3ae02e9c"]]);var j=M}}]);
//# sourceMappingURL=camera.0f765288.js.map